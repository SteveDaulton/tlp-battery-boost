{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"TLP Battery Boost \u00b6 Version 1.2.0 TLP Battery Boost is a lightweight Tkinter-based GUI for Linux laptops that optimise battery longevity with TLP . It is particularly useful for users who typically preserve battery health via configured charging thresholds but occasionally require a full charge. TLP Battery Boost provides a simple interface for switching between: Balanced Charging: TLP threshold-controlled charging behaviour. Full-Charge Boost: Temporary override to charge thresholds. How it works: \u00b6 Battery Boost reads your TLP battery thresholds and charging state using tlp-stat . Clicking the button applies a temporary override to the TLP controlled charging thresholds. This allows the battery to charge to 100%. By default, TLP restores the configured thresholds on the next reboot, or when Battery Boost re-applies them by pressing the button again. Optionally, if the configuration option RESTORE_THRESHOLDS_ON_BAT is enabled, thresholds are restored when AC power is disconnected. For further details, refer to the TLP documentation . Features \u00b6 Simple one-click toggle between configured battery-care thresholds and a full-charge override. Displays the current thresholds, battery level, and charging status. Provides light and dark desktop themes. No background services, daemons, or timers. Lightweight - built with Python and Tkinter. Security \u00b6 Authentication is handled entirely by sudo ; passwords are not stored, logged, or transmitted. Elevated privileges are cleared on exit. Getting Started \u00b6 Installation instructions Usage guide Troubleshooting API Reference (for developers) Requirements \u00b6 Linux system with TLP installed and configured Python 3.10+ Python3-tk (Tkinter) About the Project \u00b6 TLP Battery Boost is open-source (GPL-3.0) and hosted on GitHub Contributions, bug reports, and feature suggestions are welcome.","title":"Home"},{"location":"#tlp-battery-boost","text":"Version 1.2.0 TLP Battery Boost is a lightweight Tkinter-based GUI for Linux laptops that optimise battery longevity with TLP . It is particularly useful for users who typically preserve battery health via configured charging thresholds but occasionally require a full charge. TLP Battery Boost provides a simple interface for switching between: Balanced Charging: TLP threshold-controlled charging behaviour. Full-Charge Boost: Temporary override to charge thresholds.","title":"TLP Battery Boost"},{"location":"#how-it-works","text":"Battery Boost reads your TLP battery thresholds and charging state using tlp-stat . Clicking the button applies a temporary override to the TLP controlled charging thresholds. This allows the battery to charge to 100%. By default, TLP restores the configured thresholds on the next reboot, or when Battery Boost re-applies them by pressing the button again. Optionally, if the configuration option RESTORE_THRESHOLDS_ON_BAT is enabled, thresholds are restored when AC power is disconnected. For further details, refer to the TLP documentation .","title":"How it works:"},{"location":"#features","text":"Simple one-click toggle between configured battery-care thresholds and a full-charge override. Displays the current thresholds, battery level, and charging status. Provides light and dark desktop themes. No background services, daemons, or timers. Lightweight - built with Python and Tkinter.","title":"Features"},{"location":"#security","text":"Authentication is handled entirely by sudo ; passwords are not stored, logged, or transmitted. Elevated privileges are cleared on exit.","title":"Security"},{"location":"#getting-started","text":"Installation instructions Usage guide Troubleshooting API Reference (for developers)","title":"Getting Started"},{"location":"#requirements","text":"Linux system with TLP installed and configured Python 3.10+ Python3-tk (Tkinter)","title":"Requirements"},{"location":"#about-the-project","text":"TLP Battery Boost is open-source (GPL-3.0) and hosted on GitHub Contributions, bug reports, and feature suggestions are welcome.","title":"About the Project"},{"location":"appendix-api/","text":"API Reference \u00b6 This appendix provides an automatically-generated reference for all Python modules in TLP Battery Boost. Modules \u00b6 Core Application ( app.py ) Authentication ( authenticate.py ) Constants ( constants.py ) Helper Functions ( helper_functions.py ) Shell Commands ( shell_commands.py ) TLP Parser ( tlp_parser.py ) Entry Point ( __main__.py )","title":"API Reference"},{"location":"appendix-api/#api-reference","text":"This appendix provides an automatically-generated reference for all Python modules in TLP Battery Boost.","title":"API Reference"},{"location":"appendix-api/#modules","text":"Core Application ( app.py ) Authentication ( authenticate.py ) Constants ( constants.py ) Helper Functions ( helper_functions.py ) Shell Commands ( shell_commands.py ) TLP Parser ( tlp_parser.py ) Entry Point ( __main__.py )","title":"Modules"},{"location":"installation/","text":"Installation \u00b6 Requirements \u00b6 Before installing TLP Battery Boost , ensure the following prerequisites are met: A Linux laptop with an internal battery and AC power TLP installed and configured Hardware that supports TLP Battery Care . Python 3.10+ python3-tk (Tkinter) Install TLP \u00b6 TLP must be installed and active for this application to work. Most Linux distributions provide TLP through their package manager, but installation steps vary. To install the latest version of TLP, refer to the official TLP documentation: TLP installation guide After installing TLP, ensure it is enabled and running: sudo tlp start Use the following command to check that TLP is enabled and active: tlp-stat -s Install python3-tk (Tkinter) \u00b6 On many Linux distributions, Tkinter is packaged separately from Python. Install it using your distribution\u2019s package manager: Debian / Ubuntu / Mint \u00b6 sudo apt install python3-tk Fedora-based Linux systems \u00b6 sudo dnf install python3-tkinter Arch-based Linux systems \u00b6 sudo pacman -S tk CentOS, RedHat, and Oracle Linux systems: \u00b6 Package names on YUM-based distributions can vary. If python3-tkinter is not available, run sudo yum search tkinter to locate the correct one. sudo yum install python3-tkinter Installing TLP Battery Boost \u00b6 Recommended: Install via pipx (PyPI) \u00b6 The preferred installation method is to use pipx , which keeps the application isolated from system packages while still providing a command on your PATH.Install pipx using your distribution\u2019s package manager Then install TLP Battery Boost from PyPI: pipx install tlp-battery-boost Launch the application: battery_boost Note: Battery Boost will prompt for sudo password on launch. This is required to run TLP commands. Alternative: Install from Source (GitHub) \u00b6 Clone the repository: git clone https://github.com/SteveDaulton/tlp-battery-boost.git cd tlp-battery-boost Create a virtual environment: python3 -m venv .venv source .venv/bin/activate Install the package: pip install . Run the application: battery_boost Optional: Create a Desktop Launcher \u00b6 TLP Battery Boost includes a suitable icon ( tlp-battery-boost.png ) for use in desktop launchers. If you would like the application to appear in your desktop environment\u2019s application menu, create a .desktop entry: ~/.local/share/applications/tlp-battery-boost.desktop With contents such as: [Desktop Entry] Type = Application Name = TLP Battery Boost Exec = battery_boost Icon = tlp-battery-boost Terminal = false Categories = Utility; Make the launcher executable: chmod +x ~/.local/share/applications/tlp-battery-boost.desktop update-desktop-database ~/.local/share/applications Most desktop environments will locate the icon automatically if it is placed in a standard user icon directory (e.g., ~/.local/share/icons/ ). Notes \u00b6 Installing via pipx is recommended for isolation and convenience. Installing from source is useful for development or testing. Uninstallation \u00b6 If installed via pipx \u00b6 pipx uninstall tlp-battery-boost If installed from source or with pip \u00b6 Remove the virtual environment or uninstall using: pip uninstall tlp-battery-boost If running from a cloned repository, simply delete the directory. Next steps \u00b6 Proceed to the Usage guide to learn how to operate the application.","title":"Installation"},{"location":"installation/#installation","text":"","title":"Installation"},{"location":"installation/#requirements","text":"Before installing TLP Battery Boost , ensure the following prerequisites are met: A Linux laptop with an internal battery and AC power TLP installed and configured Hardware that supports TLP Battery Care . Python 3.10+ python3-tk (Tkinter)","title":"Requirements"},{"location":"installation/#install-tlp","text":"TLP must be installed and active for this application to work. Most Linux distributions provide TLP through their package manager, but installation steps vary. To install the latest version of TLP, refer to the official TLP documentation: TLP installation guide After installing TLP, ensure it is enabled and running: sudo tlp start Use the following command to check that TLP is enabled and active: tlp-stat -s","title":"Install TLP"},{"location":"installation/#install-python3-tk-tkinter","text":"On many Linux distributions, Tkinter is packaged separately from Python. Install it using your distribution\u2019s package manager:","title":"Install python3-tk (Tkinter)"},{"location":"installation/#debian-ubuntu-mint","text":"sudo apt install python3-tk","title":"Debian / Ubuntu / Mint"},{"location":"installation/#fedora-based-linux-systems","text":"sudo dnf install python3-tkinter","title":"Fedora-based Linux systems"},{"location":"installation/#arch-based-linux-systems","text":"sudo pacman -S tk","title":"Arch-based Linux systems"},{"location":"installation/#centos-redhat-and-oracle-linux-systems","text":"Package names on YUM-based distributions can vary. If python3-tkinter is not available, run sudo yum search tkinter to locate the correct one. sudo yum install python3-tkinter","title":"CentOS, RedHat, and Oracle Linux systems:"},{"location":"installation/#installing-tlp-battery-boost","text":"","title":"Installing TLP Battery Boost"},{"location":"installation/#recommended-install-via-pipx-pypi","text":"The preferred installation method is to use pipx , which keeps the application isolated from system packages while still providing a command on your PATH.Install pipx using your distribution\u2019s package manager Then install TLP Battery Boost from PyPI: pipx install tlp-battery-boost Launch the application: battery_boost Note: Battery Boost will prompt for sudo password on launch. This is required to run TLP commands.","title":"Recommended: Install via pipx (PyPI)"},{"location":"installation/#alternative-install-from-source-github","text":"Clone the repository: git clone https://github.com/SteveDaulton/tlp-battery-boost.git cd tlp-battery-boost Create a virtual environment: python3 -m venv .venv source .venv/bin/activate Install the package: pip install . Run the application: battery_boost","title":"Alternative: Install from Source (GitHub)"},{"location":"installation/#optional-create-a-desktop-launcher","text":"TLP Battery Boost includes a suitable icon ( tlp-battery-boost.png ) for use in desktop launchers. If you would like the application to appear in your desktop environment\u2019s application menu, create a .desktop entry: ~/.local/share/applications/tlp-battery-boost.desktop With contents such as: [Desktop Entry] Type = Application Name = TLP Battery Boost Exec = battery_boost Icon = tlp-battery-boost Terminal = false Categories = Utility; Make the launcher executable: chmod +x ~/.local/share/applications/tlp-battery-boost.desktop update-desktop-database ~/.local/share/applications Most desktop environments will locate the icon automatically if it is placed in a standard user icon directory (e.g., ~/.local/share/icons/ ).","title":"Optional: Create a Desktop Launcher"},{"location":"installation/#notes","text":"Installing via pipx is recommended for isolation and convenience. Installing from source is useful for development or testing.","title":"Notes"},{"location":"installation/#uninstallation","text":"","title":"Uninstallation"},{"location":"installation/#if-installed-via-pipx","text":"pipx uninstall tlp-battery-boost","title":"If installed via pipx"},{"location":"installation/#if-installed-from-source-or-with-pip","text":"Remove the virtual environment or uninstall using: pip uninstall tlp-battery-boost If running from a cloned repository, simply delete the directory.","title":"If installed from source or with pip"},{"location":"installation/#next-steps","text":"Proceed to the Usage guide to learn how to operate the application.","title":"Next steps"},{"location":"troubleshooting/","text":"Troubleshooting \u00b6 This page covers the common errors and warnings that may be encountered when using TLP Battery Boost , along with suggested actions. \"Authentication failed 3 times.\" \u00b6 Cause: The user did not enter the correct sudo password in three attempts. Action: Ensure you are typing the correct sudo password. If you continue to have trouble, verify that your user can run sudo commands from the terminal. \"Password required.\" \u00b6 Cause: The user submitted an empty password in the authentication dialog. Action: Enter your sudo password to proceed. \"Incorrect password.\" \u00b6 Cause: The user entered the wrong sudo password. Action: Try again with the correct password. Maximum three attempts are allowed. \"sudo not found on this system.\" \u00b6 Cause: Either sudo is not installed, or it is not available in your PATH, or your user cannot run sudo. Action: Install sudo using your distribution\u2019s package manager, e.g.: Ensure your user is allowed to run sudo : If you see \u201cuser is not in the sudoers file\u201d, add your user to the sudoers list following your distro\u2019s documentation. \"Authentication process timed out.\" \u00b6 Cause: Sudo prompt took too long or hung. Action: Retry launching the app. Ensure your system is responsive and no other modal dialogs are blocking sudo prompts. \"Unexpected Error ...\" (during authentication) \u00b6 Cause: Some unexpected error occurred when running sudo. Action: Check that sudo is installed and operational. Launch a terminal and run: sudo -v Resolve any issues reported there before relaunching the app. TLP errors \u00b6 These include: \"TLP is not installed or not in PATH.\" \"Error: Could not initialize TLP.\" \"TLP command failed\" \"System error while running TLP command\" \"Command not found: ...\" Cause: The app cannot execute the necessary TLP commands. This can happen if TLP is not installed correctly, if AC power is not connected (for tlp fullcharge ), or due to system errors. Action: Verify TLP is installed and operational by running in a terminal: tlp-stat -s sudo tlp fullcharge - Ensure AC power is connected when using full-charge mode. - If commands fail, resolve TLP issues before using Battery Boost. AC power required dialog \u00b6 \"Full charge mode requires AC power...\" \u00b6 Cause: The app detects that your laptop is not plugged into AC power. Action: Connect your laptop to AC power and try again. Click \"Retry\" in the dialog. \"No battery data found.\" \u00b6 Cause: TLP failed to provide battery statistics. Action: Ensure TLP is installed and active. Run in terminal to verify: sudo tlp-stat -b If the command returns battery data, relaunch the app. If not, investigate TLP configuration. Thresholds/charge appear as \"???\" \u00b6 Cause: The battery information could not be read. Action: Ensure TLP is installed and active. Ensure TLP is properly configured for your system. General Note: If you see any other errors, ensure that TLP is correctly installed and configured on your system as per the installation guide .","title":"Troubleshooting"},{"location":"troubleshooting/#troubleshooting","text":"This page covers the common errors and warnings that may be encountered when using TLP Battery Boost , along with suggested actions.","title":"Troubleshooting"},{"location":"troubleshooting/#authentication-failed-3-times","text":"Cause: The user did not enter the correct sudo password in three attempts. Action: Ensure you are typing the correct sudo password. If you continue to have trouble, verify that your user can run sudo commands from the terminal.","title":"\"Authentication failed 3 times.\""},{"location":"troubleshooting/#password-required","text":"Cause: The user submitted an empty password in the authentication dialog. Action: Enter your sudo password to proceed.","title":"\"Password required.\""},{"location":"troubleshooting/#incorrect-password","text":"Cause: The user entered the wrong sudo password. Action: Try again with the correct password. Maximum three attempts are allowed.","title":"\"Incorrect password.\""},{"location":"troubleshooting/#sudo-not-found-on-this-system","text":"Cause: Either sudo is not installed, or it is not available in your PATH, or your user cannot run sudo. Action: Install sudo using your distribution\u2019s package manager, e.g.: Ensure your user is allowed to run sudo : If you see \u201cuser is not in the sudoers file\u201d, add your user to the sudoers list following your distro\u2019s documentation.","title":"\"sudo not found on this system.\""},{"location":"troubleshooting/#authentication-process-timed-out","text":"Cause: Sudo prompt took too long or hung. Action: Retry launching the app. Ensure your system is responsive and no other modal dialogs are blocking sudo prompts.","title":"\"Authentication process timed out.\""},{"location":"troubleshooting/#unexpected-error-during-authentication","text":"Cause: Some unexpected error occurred when running sudo. Action: Check that sudo is installed and operational. Launch a terminal and run: sudo -v Resolve any issues reported there before relaunching the app.","title":"\"Unexpected Error ...\" (during authentication)"},{"location":"troubleshooting/#tlp-errors","text":"These include: \"TLP is not installed or not in PATH.\" \"Error: Could not initialize TLP.\" \"TLP command failed\" \"System error while running TLP command\" \"Command not found: ...\" Cause: The app cannot execute the necessary TLP commands. This can happen if TLP is not installed correctly, if AC power is not connected (for tlp fullcharge ), or due to system errors. Action: Verify TLP is installed and operational by running in a terminal: tlp-stat -s sudo tlp fullcharge - Ensure AC power is connected when using full-charge mode. - If commands fail, resolve TLP issues before using Battery Boost.","title":"TLP errors"},{"location":"troubleshooting/#ac-power-required-dialog","text":"","title":"AC power required dialog"},{"location":"troubleshooting/#full-charge-mode-requires-ac-power","text":"Cause: The app detects that your laptop is not plugged into AC power. Action: Connect your laptop to AC power and try again. Click \"Retry\" in the dialog.","title":"\"Full charge mode requires AC power...\""},{"location":"troubleshooting/#no-battery-data-found","text":"Cause: TLP failed to provide battery statistics. Action: Ensure TLP is installed and active. Run in terminal to verify: sudo tlp-stat -b If the command returns battery data, relaunch the app. If not, investigate TLP configuration.","title":"\"No battery data found.\""},{"location":"troubleshooting/#thresholdscharge-appear-as","text":"Cause: The battery information could not be read. Action: Ensure TLP is installed and active. Ensure TLP is properly configured for your system. General Note: If you see any other errors, ensure that TLP is correctly installed and configured on your system as per the installation guide .","title":"Thresholds/charge appear as \"???\""},{"location":"usage/","text":"Usage Guide \u00b6 Overview \u00b6 TLP Battery Boost provides a simple graphical interface for adjusting TLP\u2019s battery charge thresholds. It is intended for laptops that support charge-limit control via TLP. Launching the Application \u00b6 After installation (via pipx or pip): battery_boost Password Prompt \u00b6 When launched, the application first requests your sudo password . This is required because TLP charge-control commands (e.g. tlp fullcharge ) need root privileges. The graphical interface appears after successful authentication. If you cancel the password dialog, the application quits. Main Interface \u00b6 When launched, the application displays: Current TLP state which is initially the default profile. Current battery status (charging, waiting to charge, or discharging). Current battery thresholds (Start charge and End charge thresholds). Current battery charge as a percentage. Click to Recharge button, to enable full charging. Colour Indicators \u00b6 Battery Boost uses colour to indicate the current charging mode and power state: Normal battery-care mode The main window uses the standard theme background (white in the light theme, dark grey in the dark theme). Full-Charge Boost enabled The main window turns green (light green in the light theme, dark green in the dark theme). Button Colour: In battery-care mode, the button appears neutral (for example, light grey in the light theme). When Full-Charge Boost is active, the button adopts a green shade to match the active charging mode. If AC power is disconnected , the button turns red to indicate that the battery is discharging . Note: If your laptop has more than one battery installed, you may need to resize the interface to view the details in full. Usage \u00b6 Ensure AC power is connected to the laptop Launch the app Enter your sudo password Check the displayed charge level Click the button to commence charging to full capacity The application background will appear green when charging to full is enabled. The application may now be closed. Charging to full will continue under TLP control for as long as AC power remains connected. Alternatively, you may keep Battery Boost open to monitor the battery level in real time. Cancel full charging \u00b6 Full charge mode may be cancelled by clicking the button again. This re-applies the configured TLP battery-care thresholds. Alternatively, if the TLP configuration option RESTORE_THRESHOLDS_ON_BAT is enabled, configured thresholds are restored automatically when AC power is disconnected.","title":"Usage"},{"location":"usage/#usage-guide","text":"","title":"Usage Guide"},{"location":"usage/#overview","text":"TLP Battery Boost provides a simple graphical interface for adjusting TLP\u2019s battery charge thresholds. It is intended for laptops that support charge-limit control via TLP.","title":"Overview"},{"location":"usage/#launching-the-application","text":"After installation (via pipx or pip): battery_boost","title":"Launching the Application"},{"location":"usage/#password-prompt","text":"When launched, the application first requests your sudo password . This is required because TLP charge-control commands (e.g. tlp fullcharge ) need root privileges. The graphical interface appears after successful authentication. If you cancel the password dialog, the application quits.","title":"Password Prompt"},{"location":"usage/#main-interface","text":"When launched, the application displays: Current TLP state which is initially the default profile. Current battery status (charging, waiting to charge, or discharging). Current battery thresholds (Start charge and End charge thresholds). Current battery charge as a percentage. Click to Recharge button, to enable full charging.","title":"Main Interface"},{"location":"usage/#colour-indicators","text":"Battery Boost uses colour to indicate the current charging mode and power state: Normal battery-care mode The main window uses the standard theme background (white in the light theme, dark grey in the dark theme). Full-Charge Boost enabled The main window turns green (light green in the light theme, dark green in the dark theme). Button Colour: In battery-care mode, the button appears neutral (for example, light grey in the light theme). When Full-Charge Boost is active, the button adopts a green shade to match the active charging mode. If AC power is disconnected , the button turns red to indicate that the battery is discharging . Note: If your laptop has more than one battery installed, you may need to resize the interface to view the details in full.","title":"Colour Indicators"},{"location":"usage/#usage","text":"Ensure AC power is connected to the laptop Launch the app Enter your sudo password Check the displayed charge level Click the button to commence charging to full capacity The application background will appear green when charging to full is enabled. The application may now be closed. Charging to full will continue under TLP control for as long as AC power remains connected. Alternatively, you may keep Battery Boost open to monitor the battery level in real time.","title":"Usage"},{"location":"usage/#cancel-full-charging","text":"Full charge mode may be cancelled by clicking the button again. This re-applies the configured TLP battery-care thresholds. Alternatively, if the TLP configuration option RESTORE_THRESHOLDS_ON_BAT is enabled, configured thresholds are restored automatically when AC power is disconnected.","title":"Cancel full charging"},{"location":"api/__main__/","text":"battery_boost.__main__ \u00b6 Entry point for the Battery Boost application. Initialises and launches the Tkinter GUI for managing TLP battery charge profiles. Battery Boost allows users to toggle between normal optimization and full-charge modes, with battery status display. main \u00b6 Entry point of the TLP Battery Boost application. Configures the logging level based on the DEBUG constant. Parses command-line arguments to determine the GUI theme and font settings. Instantiates the main App class with the chosen theme and fonts. Starts the Tkinter main event loop. Handles user interrupts and ensures clean shutdown. Revokes any elevated permissions acquired during execution. Raises: Type Description KeyboardInterrupt Gracefully exits if the user sends an interrupt signal (e.g., Ctrl+C). The GUI is destroyed if it was created. Exception Any unhandled exception during app initialization or execution is logged as critical and causes the program to exit with a non-zero status. Source code in src/battery_boost/__main__.py 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 def main () -> None : \"\"\"Entry point of the TLP Battery Boost application. - Configures the logging level based on the `DEBUG` constant. - Parses command-line arguments to determine the GUI theme and font settings. - Instantiates the main `App` class with the chosen theme and fonts. - Starts the Tkinter main event loop. - Handles user interrupts and ensures clean shutdown. - Revokes any elevated permissions acquired during execution. Exceptions: KeyboardInterrupt: Gracefully exits if the user sends an interrupt signal (e.g., Ctrl+C). The GUI is destroyed if it was created. Exception: Any unhandled exception during app initialization or execution is logged as critical and causes the program to exit with a non-zero status. \"\"\" debug_level = logging . DEBUG if DEBUG else logging . WARNING logging . basicConfig ( level = debug_level , format = \" %(levelname)s : %(name)s %(message)s \" , ) theme_choice , font_normal , font_small , factor = parse_args ( sys . argv [ 1 :]) app = None try : app = App ( theme_choice , font_normal , font_small , factor ) app . mainloop () except KeyboardInterrupt : if app : app . destroy () # Catchall if App fails to launch with unhandled exception. except Exception as exc : # pylint: disable=broad-exception-caught logging . critical ( exc ) sys . exit ( 1 ) finally : revoke_permissions ()","title":"__main__.py"},{"location":"api/__main__/#battery_boost.__main__","text":"Entry point for the Battery Boost application. Initialises and launches the Tkinter GUI for managing TLP battery charge profiles. Battery Boost allows users to toggle between normal optimization and full-charge modes, with battery status display.","title":"__main__"},{"location":"api/__main__/#battery_boost.__main__.main","text":"Entry point of the TLP Battery Boost application. Configures the logging level based on the DEBUG constant. Parses command-line arguments to determine the GUI theme and font settings. Instantiates the main App class with the chosen theme and fonts. Starts the Tkinter main event loop. Handles user interrupts and ensures clean shutdown. Revokes any elevated permissions acquired during execution. Raises: Type Description KeyboardInterrupt Gracefully exits if the user sends an interrupt signal (e.g., Ctrl+C). The GUI is destroyed if it was created. Exception Any unhandled exception during app initialization or execution is logged as critical and causes the program to exit with a non-zero status. Source code in src/battery_boost/__main__.py 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 def main () -> None : \"\"\"Entry point of the TLP Battery Boost application. - Configures the logging level based on the `DEBUG` constant. - Parses command-line arguments to determine the GUI theme and font settings. - Instantiates the main `App` class with the chosen theme and fonts. - Starts the Tkinter main event loop. - Handles user interrupts and ensures clean shutdown. - Revokes any elevated permissions acquired during execution. Exceptions: KeyboardInterrupt: Gracefully exits if the user sends an interrupt signal (e.g., Ctrl+C). The GUI is destroyed if it was created. Exception: Any unhandled exception during app initialization or execution is logged as critical and causes the program to exit with a non-zero status. \"\"\" debug_level = logging . DEBUG if DEBUG else logging . WARNING logging . basicConfig ( level = debug_level , format = \" %(levelname)s : %(name)s %(message)s \" , ) theme_choice , font_normal , font_small , factor = parse_args ( sys . argv [ 1 :]) app = None try : app = App ( theme_choice , font_normal , font_small , factor ) app . mainloop () except KeyboardInterrupt : if app : app . destroy () # Catchall if App fails to launch with unhandled exception. except Exception as exc : # pylint: disable=broad-exception-caught logging . critical ( exc ) sys . exit ( 1 ) finally : revoke_permissions ()","title":"main"},{"location":"api/app/","text":"battery_boost.app \u00b6 Tkinter GUI for managing TLP battery charge profiles. Provides a simple interface to toggle between normal and full-charge modes, refresh sudo authentication, and display battery statistics. App \u00b6 Bases: Tk Tkinter GUI for toggling TLP battery charge profiles. Supports switching between normal ('default') and full-charge ('recharge') modes and periodically refreshes display of battery statistics. Source code in src/battery_boost/app.py 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 class App ( tk . Tk ): # pylint: disable=too-many-instance-attributes \"\"\"Tkinter GUI for toggling TLP battery charge profiles. Supports switching between normal ('default') and full-charge ('recharge') modes and periodically refreshes display of battery statistics. \"\"\" def __init__ ( self , theme : ThemeKeys = DEFAULT_THEME , standard_font : tuple [ str , int ] = ( 'TkDefaultFont' , 12 ), small_font : tuple [ str , int ] = ( 'TkDefaultFont' , 10 ), scale_factor : float = 1.0 , ) -> None : \"\"\"Initialize the Tkinter UI, state, and baseline TLP configuration. Args: theme: Theme colors to apply. standard_font: Font for main UI elements. small_font: Font for secondary UI elements. scale_factor: Scale factor for UI sizing. \"\"\" super () . __init__ () self . _refresh_job : str | None = None self . theme = theme self . standard_font = standard_font self . small_font = small_font self . scale_factor = scale_factor self . withdraw () self . protocol ( 'WM_DELETE_WINDOW' , self . quit_app ) # Fail early if TLP not available. self . _verify_tlp_ready () # Ensure AC power connected. while not self . is_on_ac_power (): pass # Acquire root for commands. authenticate ( self ) self . ui_state : BatteryState = BatteryState . DEFAULT self . _init_window () self . _init_styles () self . _init_widgets () self . _layout_widgets () # Bind Ctrl+Q keyboard shortcut self . bind ( '<Control-KeyPress-q>' , lambda e : self . quit_app ()) # Show main window. self . deiconify () # Ensure TLP is in a known (default enabled) state. initialise_tlp ( self ) self . apply_state () self . battery_stats = get_battery_stats () self . write_stats ( self . battery_stats [ 'info' ]) self . refresh_battery_stats () def _init_window ( self ) -> None : \"\"\"Initialize the window.\"\"\" self . title ( 'Battery Boost' ) self . geometry ( f ' { int ( 400 * self . scale_factor ) } x { int ( 450 * self . scale_factor ) } ' ) self . minsize ( int ( 200 * self . scale_factor ), int ( 150 * self . scale_factor )) self . maxsize ( int ( 600 * self . scale_factor ), int ( 600 * self . scale_factor )) def _init_styles ( self ) -> None : \"\"\"ttk Style setup\"\"\" style = ttk . Style ( self ) style . theme_use ( 'clam' ) # 'clam' allows color customizations. # Button state styles. btn_common = { 'relief' : 'flat' , 'font' : self . standard_font } _opts = { ** btn_common , 'background' : self . theme [ 'btn_normal' ], 'foreground' : self . theme [ 'text' ]} style . configure ( 'Default.TButton' , ** _opts ) style . map ( 'Default.TButton' , background = [( 'active' , self . theme [ 'btn_active_normal' ])]) _opts = { ** btn_common , 'background' : self . theme [ 'btn_charge' ], 'foreground' : self . theme [ 'text' ]} style . configure ( 'Recharge.TButton' , ** _opts ) style . map ( 'Recharge.TButton' , background = [( 'active' , self . theme [ 'btn_active_charge' ])]) _opts = { ** btn_common , 'foreground' : self . theme [ 'btn_discharge_text' ], 'background' : self . theme [ 'btn_discharge' ]} style . configure ( 'Discharge.TButton' , ** _opts ) style . map ( 'Discharge.TButton' , background = [( 'active' , self . theme [ 'btn_active_discharge' ])]) # Label styles - Top Label. top_label_common = { 'foreground' : self . theme [ 'text' ], 'font' : self . standard_font } _opts = { ** top_label_common , 'background' : self . theme [ 'default_bg' ]} style . configure ( 'Default.TLabel' , ** _opts ) _opts = { ** top_label_common , 'background' : self . theme [ 'charge_bg' ]} style . configure ( 'Recharge.TLabel' , ** _opts ) # Instruction label. instruction_label_common = { 'foreground' : self . theme [ 'text' ], 'font' : self . small_font } _opts = { ** instruction_label_common , 'background' : self . theme [ 'default_bg' ]} style . configure ( 'DefaultInstruction.TLabel' , ** _opts ) _opts = { ** instruction_label_common , 'background' : self . theme [ 'charge_bg' ]} style . configure ( 'RechargeInstruction.TLabel' , ** _opts ) self . style = style def _init_widgets ( self ) -> None : self . top_label = ttk . Label ( self , style = 'Default.TLabel' ) self . button = ttk . Button ( self , style = 'Default.TButton' , command = self . toggle_state ) instructions = ( \"AC power must be connected. \\n\\n \" \"You can close this api after \\n \" \"selecting the required profile.\" ) self . instruction_label = ttk . Label ( self , style = 'DefaultInstruction.TLabel' , text = instructions , justify = 'center' ) self . text_box = tk . Text ( self , height = 2 , background = self . theme [ 'default_bg' ], foreground = self . theme [ 'text' ], font = self . small_font ) # noinspection PyTypeChecker self . text_box . config ( state = tk . DISABLED ) def _layout_widgets ( self ) -> None : self . top_label . pack ( pady = int ( 10 * self . scale_factor )) self . button . pack () self . instruction_label . pack ( pady = ( int ( 5 * self . scale_factor ), int ( 10 * self . scale_factor ))) # noinspection PyTypeChecker self . text_box . pack ( padx = int ( 10 * self . scale_factor ), pady = int ( 10 * self . scale_factor ), expand = True , fill = tk . BOTH ) def _verify_tlp_ready ( self ) -> None : \"\"\"Verify that TLP is installed and active. Quit on fatal error.\"\"\" if not command_on_path ( 'tlp' ): self . quit_on_error ( \"TLP is not installed or not in PATH.\" , \"Fatal Error\" ) if command_on_path ( 'systemctl' ): if not tlp_running (): self . quit_on_error ( \"TLP service is not active.\" , \"Fatal Error\" ) elif not tlp_active (): # Less reliable fallback. self . quit_on_error ( \"TLP service is not active.\" , \"Fatal Error\" ) def is_on_ac_power ( self ) -> bool : \"\"\"Check if api is on AC power.\"\"\" try : if on_ac_power (): return True except RuntimeError as exc : self . quit_on_error ( str ( exc ), \"Unsupported system\" ) retry = messagebox . askretrycancel ( \"AC Power Required\" , \"Full charge mode requires AC power. \\n \" \"Plug in your laptop and try again.\" , parent = self , icon = 'warning' ) if not retry : # Cancel button pressed. self . quit_app ( \"AC power not connected.\" ) return False # Non-fatal failure def refresh_battery_stats ( self ) -> None : \"\"\"Periodically refresh the battery statistics.\"\"\" logger . debug ( \"Refreshing battery statistics\" ) new_battery_stats = get_battery_stats () current_battery_info = self . battery_stats [ 'info' ] new_battery_info = new_battery_stats [ 'info' ] # Handle updating button appearance on battery discharge. self . update_button ( new_battery_stats [ 'discharging' ]) # Update text widget info. if current_battery_info != new_battery_info : self . battery_stats = new_battery_stats self . write_stats ( new_battery_info ) # noinspection PyTypeChecker self . _refresh_job = self . after ( REFRESH_INTERVAL_MS , self . refresh_battery_stats ) def update_button ( self , is_discharging : bool ) -> None : \"\"\"Update button appearance to match battery status.\"\"\" prev_btn_style = self . button . cget ( \"style\" ) if is_discharging : new_style = 'Discharge.TButton' elif self . ui_state is BatteryState . RECHARGE : new_style = 'Recharge.TButton' else : new_style = 'Default.TButton' if new_style != prev_btn_style : self . button . configure ( style = new_style ) def quit_on_error ( self , error_message : str , title : str = \"Error\" ) -> NoReturn : \"\"\"Display Error dialog and quit.\"\"\" messagebox . showerror ( title , error_message , parent = self ) self . quit_app ( f \"Error: { error_message } \" ) def quit_app ( self , status : int | str = 0 ) -> NoReturn : \"\"\"Terminate the application, cancel scheduled jobs, and exit. Args: status: Optional exit code or message. \"\"\" if self . _refresh_job : try : self . after_cancel ( self . _refresh_job ) except ( tk . TclError , RuntimeError ) as exc : logger . critical ( \"quit_app failed to cancel job %s \" , exc ) self . destroy () sys . exit ( status ) def apply_state ( self ) -> None : \"\"\"Update the UI to reflect the current battery profile state.\"\"\" state = STATES [ self . ui_state ] # Window background (non-style background change) background = ( self . theme [ 'default_bg' ] if self . ui_state is BatteryState . DEFAULT else self . theme [ 'charge_bg' ]) self . configure ( background = background ) # Update styles if self . ui_state is BatteryState . RECHARGE : top_label_style = 'Recharge.TLabel' instruction_label_style = 'RechargeInstruction.TLabel' button_style = 'Recharge.TButton' else : top_label_style = 'Default.TLabel' instruction_label_style = 'DefaultInstruction.TLabel' button_style = 'Default.TButton' self . top_label . configure ( style = top_label_style , text = state [ 'label_text' ]) self . instruction_label . configure ( style = instruction_label_style ) self . button . configure ( style = button_style , text = state [ 'button_text' ]) # Text box (tk widget does not have ttk style). self . text_box . config ( background = background , foreground = self . theme [ 'text' ]) def toggle_state ( self ) -> None : \"\"\"Switch between default and full-charge profiles and update the UI.\"\"\" if not tlp_toggle_state ( self , self . ui_state ): return # Flip UI state self . ui_state = ( BatteryState . DEFAULT if self . ui_state == BatteryState . RECHARGE else BatteryState . RECHARGE ) self . apply_state () # Update text widget. self . battery_stats = get_battery_stats () self . write_stats ( self . battery_stats [ 'info' ]) return def write_stats ( self , stats : str ) -> None : \"\"\"Update the text area with the current TLP battery stats.\"\"\" stats = STATES [ self . ui_state ][ 'action' ] + stats logger . debug ( stats ) # noinspection PyTypeChecker self . text_box . config ( state = tk . NORMAL ) self . text_box . delete ( '1.0' , tk . END ) self . text_box . insert ( tk . END , stats ) # noinspection PyTypeChecker self . text_box . config ( state = tk . DISABLED ) __init__ \u00b6 Initialize the Tkinter UI, state, and baseline TLP configuration. Parameters: Name Type Description Default theme ThemeKeys Theme colors to apply. DEFAULT_THEME standard_font tuple [ str , int ] Font for main UI elements. ('TkDefaultFont', 12) small_font tuple [ str , int ] Font for secondary UI elements. ('TkDefaultFont', 10) scale_factor float Scale factor for UI sizing. 1.0 Source code in src/battery_boost/app.py 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 def __init__ ( self , theme : ThemeKeys = DEFAULT_THEME , standard_font : tuple [ str , int ] = ( 'TkDefaultFont' , 12 ), small_font : tuple [ str , int ] = ( 'TkDefaultFont' , 10 ), scale_factor : float = 1.0 , ) -> None : \"\"\"Initialize the Tkinter UI, state, and baseline TLP configuration. Args: theme: Theme colors to apply. standard_font: Font for main UI elements. small_font: Font for secondary UI elements. scale_factor: Scale factor for UI sizing. \"\"\" super () . __init__ () self . _refresh_job : str | None = None self . theme = theme self . standard_font = standard_font self . small_font = small_font self . scale_factor = scale_factor self . withdraw () self . protocol ( 'WM_DELETE_WINDOW' , self . quit_app ) # Fail early if TLP not available. self . _verify_tlp_ready () # Ensure AC power connected. while not self . is_on_ac_power (): pass # Acquire root for commands. authenticate ( self ) self . ui_state : BatteryState = BatteryState . DEFAULT self . _init_window () self . _init_styles () self . _init_widgets () self . _layout_widgets () # Bind Ctrl+Q keyboard shortcut self . bind ( '<Control-KeyPress-q>' , lambda e : self . quit_app ()) # Show main window. self . deiconify () # Ensure TLP is in a known (default enabled) state. initialise_tlp ( self ) self . apply_state () self . battery_stats = get_battery_stats () self . write_stats ( self . battery_stats [ 'info' ]) self . refresh_battery_stats () apply_state \u00b6 Update the UI to reflect the current battery profile state. Source code in src/battery_boost/app.py 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 def apply_state ( self ) -> None : \"\"\"Update the UI to reflect the current battery profile state.\"\"\" state = STATES [ self . ui_state ] # Window background (non-style background change) background = ( self . theme [ 'default_bg' ] if self . ui_state is BatteryState . DEFAULT else self . theme [ 'charge_bg' ]) self . configure ( background = background ) # Update styles if self . ui_state is BatteryState . RECHARGE : top_label_style = 'Recharge.TLabel' instruction_label_style = 'RechargeInstruction.TLabel' button_style = 'Recharge.TButton' else : top_label_style = 'Default.TLabel' instruction_label_style = 'DefaultInstruction.TLabel' button_style = 'Default.TButton' self . top_label . configure ( style = top_label_style , text = state [ 'label_text' ]) self . instruction_label . configure ( style = instruction_label_style ) self . button . configure ( style = button_style , text = state [ 'button_text' ]) # Text box (tk widget does not have ttk style). self . text_box . config ( background = background , foreground = self . theme [ 'text' ]) is_on_ac_power \u00b6 Check if api is on AC power. Source code in src/battery_boost/app.py 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 def is_on_ac_power ( self ) -> bool : \"\"\"Check if api is on AC power.\"\"\" try : if on_ac_power (): return True except RuntimeError as exc : self . quit_on_error ( str ( exc ), \"Unsupported system\" ) retry = messagebox . askretrycancel ( \"AC Power Required\" , \"Full charge mode requires AC power. \\n \" \"Plug in your laptop and try again.\" , parent = self , icon = 'warning' ) if not retry : # Cancel button pressed. self . quit_app ( \"AC power not connected.\" ) return False # Non-fatal failure quit_app \u00b6 Terminate the application, cancel scheduled jobs, and exit. Parameters: Name Type Description Default status int | str Optional exit code or message. 0 Source code in src/battery_boost/app.py 247 248 249 250 251 252 253 254 255 256 257 258 259 def quit_app ( self , status : int | str = 0 ) -> NoReturn : \"\"\"Terminate the application, cancel scheduled jobs, and exit. Args: status: Optional exit code or message. \"\"\" if self . _refresh_job : try : self . after_cancel ( self . _refresh_job ) except ( tk . TclError , RuntimeError ) as exc : logger . critical ( \"quit_app failed to cancel job %s \" , exc ) self . destroy () sys . exit ( status ) quit_on_error \u00b6 Display Error dialog and quit. Source code in src/battery_boost/app.py 242 243 244 245 def quit_on_error ( self , error_message : str , title : str = \"Error\" ) -> NoReturn : \"\"\"Display Error dialog and quit.\"\"\" messagebox . showerror ( title , error_message , parent = self ) self . quit_app ( f \"Error: { error_message } \" ) refresh_battery_stats \u00b6 Periodically refresh the battery statistics. Source code in src/battery_boost/app.py 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 def refresh_battery_stats ( self ) -> None : \"\"\"Periodically refresh the battery statistics.\"\"\" logger . debug ( \"Refreshing battery statistics\" ) new_battery_stats = get_battery_stats () current_battery_info = self . battery_stats [ 'info' ] new_battery_info = new_battery_stats [ 'info' ] # Handle updating button appearance on battery discharge. self . update_button ( new_battery_stats [ 'discharging' ]) # Update text widget info. if current_battery_info != new_battery_info : self . battery_stats = new_battery_stats self . write_stats ( new_battery_info ) # noinspection PyTypeChecker self . _refresh_job = self . after ( REFRESH_INTERVAL_MS , self . refresh_battery_stats ) toggle_state \u00b6 Switch between default and full-charge profiles and update the UI. Source code in src/battery_boost/app.py 288 289 290 291 292 293 294 295 296 297 298 299 300 301 def toggle_state ( self ) -> None : \"\"\"Switch between default and full-charge profiles and update the UI.\"\"\" if not tlp_toggle_state ( self , self . ui_state ): return # Flip UI state self . ui_state = ( BatteryState . DEFAULT if self . ui_state == BatteryState . RECHARGE else BatteryState . RECHARGE ) self . apply_state () # Update text widget. self . battery_stats = get_battery_stats () self . write_stats ( self . battery_stats [ 'info' ]) return update_button \u00b6 Update button appearance to match battery status. Source code in src/battery_boost/app.py 230 231 232 233 234 235 236 237 238 239 240 def update_button ( self , is_discharging : bool ) -> None : \"\"\"Update button appearance to match battery status.\"\"\" prev_btn_style = self . button . cget ( \"style\" ) if is_discharging : new_style = 'Discharge.TButton' elif self . ui_state is BatteryState . RECHARGE : new_style = 'Recharge.TButton' else : new_style = 'Default.TButton' if new_style != prev_btn_style : self . button . configure ( style = new_style ) write_stats \u00b6 Update the text area with the current TLP battery stats. Source code in src/battery_boost/app.py 303 304 305 306 307 308 309 310 311 312 def write_stats ( self , stats : str ) -> None : \"\"\"Update the text area with the current TLP battery stats.\"\"\" stats = STATES [ self . ui_state ][ 'action' ] + stats logger . debug ( stats ) # noinspection PyTypeChecker self . text_box . config ( state = tk . NORMAL ) self . text_box . delete ( '1.0' , tk . END ) self . text_box . insert ( tk . END , stats ) # noinspection PyTypeChecker self . text_box . config ( state = tk . DISABLED )","title":"app.py"},{"location":"api/app/#battery_boost.app","text":"Tkinter GUI for managing TLP battery charge profiles. Provides a simple interface to toggle between normal and full-charge modes, refresh sudo authentication, and display battery statistics.","title":"app"},{"location":"api/app/#battery_boost.app.App","text":"Bases: Tk Tkinter GUI for toggling TLP battery charge profiles. Supports switching between normal ('default') and full-charge ('recharge') modes and periodically refreshes display of battery statistics. Source code in src/battery_boost/app.py 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 class App ( tk . Tk ): # pylint: disable=too-many-instance-attributes \"\"\"Tkinter GUI for toggling TLP battery charge profiles. Supports switching between normal ('default') and full-charge ('recharge') modes and periodically refreshes display of battery statistics. \"\"\" def __init__ ( self , theme : ThemeKeys = DEFAULT_THEME , standard_font : tuple [ str , int ] = ( 'TkDefaultFont' , 12 ), small_font : tuple [ str , int ] = ( 'TkDefaultFont' , 10 ), scale_factor : float = 1.0 , ) -> None : \"\"\"Initialize the Tkinter UI, state, and baseline TLP configuration. Args: theme: Theme colors to apply. standard_font: Font for main UI elements. small_font: Font for secondary UI elements. scale_factor: Scale factor for UI sizing. \"\"\" super () . __init__ () self . _refresh_job : str | None = None self . theme = theme self . standard_font = standard_font self . small_font = small_font self . scale_factor = scale_factor self . withdraw () self . protocol ( 'WM_DELETE_WINDOW' , self . quit_app ) # Fail early if TLP not available. self . _verify_tlp_ready () # Ensure AC power connected. while not self . is_on_ac_power (): pass # Acquire root for commands. authenticate ( self ) self . ui_state : BatteryState = BatteryState . DEFAULT self . _init_window () self . _init_styles () self . _init_widgets () self . _layout_widgets () # Bind Ctrl+Q keyboard shortcut self . bind ( '<Control-KeyPress-q>' , lambda e : self . quit_app ()) # Show main window. self . deiconify () # Ensure TLP is in a known (default enabled) state. initialise_tlp ( self ) self . apply_state () self . battery_stats = get_battery_stats () self . write_stats ( self . battery_stats [ 'info' ]) self . refresh_battery_stats () def _init_window ( self ) -> None : \"\"\"Initialize the window.\"\"\" self . title ( 'Battery Boost' ) self . geometry ( f ' { int ( 400 * self . scale_factor ) } x { int ( 450 * self . scale_factor ) } ' ) self . minsize ( int ( 200 * self . scale_factor ), int ( 150 * self . scale_factor )) self . maxsize ( int ( 600 * self . scale_factor ), int ( 600 * self . scale_factor )) def _init_styles ( self ) -> None : \"\"\"ttk Style setup\"\"\" style = ttk . Style ( self ) style . theme_use ( 'clam' ) # 'clam' allows color customizations. # Button state styles. btn_common = { 'relief' : 'flat' , 'font' : self . standard_font } _opts = { ** btn_common , 'background' : self . theme [ 'btn_normal' ], 'foreground' : self . theme [ 'text' ]} style . configure ( 'Default.TButton' , ** _opts ) style . map ( 'Default.TButton' , background = [( 'active' , self . theme [ 'btn_active_normal' ])]) _opts = { ** btn_common , 'background' : self . theme [ 'btn_charge' ], 'foreground' : self . theme [ 'text' ]} style . configure ( 'Recharge.TButton' , ** _opts ) style . map ( 'Recharge.TButton' , background = [( 'active' , self . theme [ 'btn_active_charge' ])]) _opts = { ** btn_common , 'foreground' : self . theme [ 'btn_discharge_text' ], 'background' : self . theme [ 'btn_discharge' ]} style . configure ( 'Discharge.TButton' , ** _opts ) style . map ( 'Discharge.TButton' , background = [( 'active' , self . theme [ 'btn_active_discharge' ])]) # Label styles - Top Label. top_label_common = { 'foreground' : self . theme [ 'text' ], 'font' : self . standard_font } _opts = { ** top_label_common , 'background' : self . theme [ 'default_bg' ]} style . configure ( 'Default.TLabel' , ** _opts ) _opts = { ** top_label_common , 'background' : self . theme [ 'charge_bg' ]} style . configure ( 'Recharge.TLabel' , ** _opts ) # Instruction label. instruction_label_common = { 'foreground' : self . theme [ 'text' ], 'font' : self . small_font } _opts = { ** instruction_label_common , 'background' : self . theme [ 'default_bg' ]} style . configure ( 'DefaultInstruction.TLabel' , ** _opts ) _opts = { ** instruction_label_common , 'background' : self . theme [ 'charge_bg' ]} style . configure ( 'RechargeInstruction.TLabel' , ** _opts ) self . style = style def _init_widgets ( self ) -> None : self . top_label = ttk . Label ( self , style = 'Default.TLabel' ) self . button = ttk . Button ( self , style = 'Default.TButton' , command = self . toggle_state ) instructions = ( \"AC power must be connected. \\n\\n \" \"You can close this api after \\n \" \"selecting the required profile.\" ) self . instruction_label = ttk . Label ( self , style = 'DefaultInstruction.TLabel' , text = instructions , justify = 'center' ) self . text_box = tk . Text ( self , height = 2 , background = self . theme [ 'default_bg' ], foreground = self . theme [ 'text' ], font = self . small_font ) # noinspection PyTypeChecker self . text_box . config ( state = tk . DISABLED ) def _layout_widgets ( self ) -> None : self . top_label . pack ( pady = int ( 10 * self . scale_factor )) self . button . pack () self . instruction_label . pack ( pady = ( int ( 5 * self . scale_factor ), int ( 10 * self . scale_factor ))) # noinspection PyTypeChecker self . text_box . pack ( padx = int ( 10 * self . scale_factor ), pady = int ( 10 * self . scale_factor ), expand = True , fill = tk . BOTH ) def _verify_tlp_ready ( self ) -> None : \"\"\"Verify that TLP is installed and active. Quit on fatal error.\"\"\" if not command_on_path ( 'tlp' ): self . quit_on_error ( \"TLP is not installed or not in PATH.\" , \"Fatal Error\" ) if command_on_path ( 'systemctl' ): if not tlp_running (): self . quit_on_error ( \"TLP service is not active.\" , \"Fatal Error\" ) elif not tlp_active (): # Less reliable fallback. self . quit_on_error ( \"TLP service is not active.\" , \"Fatal Error\" ) def is_on_ac_power ( self ) -> bool : \"\"\"Check if api is on AC power.\"\"\" try : if on_ac_power (): return True except RuntimeError as exc : self . quit_on_error ( str ( exc ), \"Unsupported system\" ) retry = messagebox . askretrycancel ( \"AC Power Required\" , \"Full charge mode requires AC power. \\n \" \"Plug in your laptop and try again.\" , parent = self , icon = 'warning' ) if not retry : # Cancel button pressed. self . quit_app ( \"AC power not connected.\" ) return False # Non-fatal failure def refresh_battery_stats ( self ) -> None : \"\"\"Periodically refresh the battery statistics.\"\"\" logger . debug ( \"Refreshing battery statistics\" ) new_battery_stats = get_battery_stats () current_battery_info = self . battery_stats [ 'info' ] new_battery_info = new_battery_stats [ 'info' ] # Handle updating button appearance on battery discharge. self . update_button ( new_battery_stats [ 'discharging' ]) # Update text widget info. if current_battery_info != new_battery_info : self . battery_stats = new_battery_stats self . write_stats ( new_battery_info ) # noinspection PyTypeChecker self . _refresh_job = self . after ( REFRESH_INTERVAL_MS , self . refresh_battery_stats ) def update_button ( self , is_discharging : bool ) -> None : \"\"\"Update button appearance to match battery status.\"\"\" prev_btn_style = self . button . cget ( \"style\" ) if is_discharging : new_style = 'Discharge.TButton' elif self . ui_state is BatteryState . RECHARGE : new_style = 'Recharge.TButton' else : new_style = 'Default.TButton' if new_style != prev_btn_style : self . button . configure ( style = new_style ) def quit_on_error ( self , error_message : str , title : str = \"Error\" ) -> NoReturn : \"\"\"Display Error dialog and quit.\"\"\" messagebox . showerror ( title , error_message , parent = self ) self . quit_app ( f \"Error: { error_message } \" ) def quit_app ( self , status : int | str = 0 ) -> NoReturn : \"\"\"Terminate the application, cancel scheduled jobs, and exit. Args: status: Optional exit code or message. \"\"\" if self . _refresh_job : try : self . after_cancel ( self . _refresh_job ) except ( tk . TclError , RuntimeError ) as exc : logger . critical ( \"quit_app failed to cancel job %s \" , exc ) self . destroy () sys . exit ( status ) def apply_state ( self ) -> None : \"\"\"Update the UI to reflect the current battery profile state.\"\"\" state = STATES [ self . ui_state ] # Window background (non-style background change) background = ( self . theme [ 'default_bg' ] if self . ui_state is BatteryState . DEFAULT else self . theme [ 'charge_bg' ]) self . configure ( background = background ) # Update styles if self . ui_state is BatteryState . RECHARGE : top_label_style = 'Recharge.TLabel' instruction_label_style = 'RechargeInstruction.TLabel' button_style = 'Recharge.TButton' else : top_label_style = 'Default.TLabel' instruction_label_style = 'DefaultInstruction.TLabel' button_style = 'Default.TButton' self . top_label . configure ( style = top_label_style , text = state [ 'label_text' ]) self . instruction_label . configure ( style = instruction_label_style ) self . button . configure ( style = button_style , text = state [ 'button_text' ]) # Text box (tk widget does not have ttk style). self . text_box . config ( background = background , foreground = self . theme [ 'text' ]) def toggle_state ( self ) -> None : \"\"\"Switch between default and full-charge profiles and update the UI.\"\"\" if not tlp_toggle_state ( self , self . ui_state ): return # Flip UI state self . ui_state = ( BatteryState . DEFAULT if self . ui_state == BatteryState . RECHARGE else BatteryState . RECHARGE ) self . apply_state () # Update text widget. self . battery_stats = get_battery_stats () self . write_stats ( self . battery_stats [ 'info' ]) return def write_stats ( self , stats : str ) -> None : \"\"\"Update the text area with the current TLP battery stats.\"\"\" stats = STATES [ self . ui_state ][ 'action' ] + stats logger . debug ( stats ) # noinspection PyTypeChecker self . text_box . config ( state = tk . NORMAL ) self . text_box . delete ( '1.0' , tk . END ) self . text_box . insert ( tk . END , stats ) # noinspection PyTypeChecker self . text_box . config ( state = tk . DISABLED )","title":"App"},{"location":"api/app/#battery_boost.app.App.__init__","text":"Initialize the Tkinter UI, state, and baseline TLP configuration. Parameters: Name Type Description Default theme ThemeKeys Theme colors to apply. DEFAULT_THEME standard_font tuple [ str , int ] Font for main UI elements. ('TkDefaultFont', 12) small_font tuple [ str , int ] Font for secondary UI elements. ('TkDefaultFont', 10) scale_factor float Scale factor for UI sizing. 1.0 Source code in src/battery_boost/app.py 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 def __init__ ( self , theme : ThemeKeys = DEFAULT_THEME , standard_font : tuple [ str , int ] = ( 'TkDefaultFont' , 12 ), small_font : tuple [ str , int ] = ( 'TkDefaultFont' , 10 ), scale_factor : float = 1.0 , ) -> None : \"\"\"Initialize the Tkinter UI, state, and baseline TLP configuration. Args: theme: Theme colors to apply. standard_font: Font for main UI elements. small_font: Font for secondary UI elements. scale_factor: Scale factor for UI sizing. \"\"\" super () . __init__ () self . _refresh_job : str | None = None self . theme = theme self . standard_font = standard_font self . small_font = small_font self . scale_factor = scale_factor self . withdraw () self . protocol ( 'WM_DELETE_WINDOW' , self . quit_app ) # Fail early if TLP not available. self . _verify_tlp_ready () # Ensure AC power connected. while not self . is_on_ac_power (): pass # Acquire root for commands. authenticate ( self ) self . ui_state : BatteryState = BatteryState . DEFAULT self . _init_window () self . _init_styles () self . _init_widgets () self . _layout_widgets () # Bind Ctrl+Q keyboard shortcut self . bind ( '<Control-KeyPress-q>' , lambda e : self . quit_app ()) # Show main window. self . deiconify () # Ensure TLP is in a known (default enabled) state. initialise_tlp ( self ) self . apply_state () self . battery_stats = get_battery_stats () self . write_stats ( self . battery_stats [ 'info' ]) self . refresh_battery_stats ()","title":"__init__"},{"location":"api/app/#battery_boost.app.App.apply_state","text":"Update the UI to reflect the current battery profile state. Source code in src/battery_boost/app.py 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 def apply_state ( self ) -> None : \"\"\"Update the UI to reflect the current battery profile state.\"\"\" state = STATES [ self . ui_state ] # Window background (non-style background change) background = ( self . theme [ 'default_bg' ] if self . ui_state is BatteryState . DEFAULT else self . theme [ 'charge_bg' ]) self . configure ( background = background ) # Update styles if self . ui_state is BatteryState . RECHARGE : top_label_style = 'Recharge.TLabel' instruction_label_style = 'RechargeInstruction.TLabel' button_style = 'Recharge.TButton' else : top_label_style = 'Default.TLabel' instruction_label_style = 'DefaultInstruction.TLabel' button_style = 'Default.TButton' self . top_label . configure ( style = top_label_style , text = state [ 'label_text' ]) self . instruction_label . configure ( style = instruction_label_style ) self . button . configure ( style = button_style , text = state [ 'button_text' ]) # Text box (tk widget does not have ttk style). self . text_box . config ( background = background , foreground = self . theme [ 'text' ])","title":"apply_state"},{"location":"api/app/#battery_boost.app.App.is_on_ac_power","text":"Check if api is on AC power. Source code in src/battery_boost/app.py 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 def is_on_ac_power ( self ) -> bool : \"\"\"Check if api is on AC power.\"\"\" try : if on_ac_power (): return True except RuntimeError as exc : self . quit_on_error ( str ( exc ), \"Unsupported system\" ) retry = messagebox . askretrycancel ( \"AC Power Required\" , \"Full charge mode requires AC power. \\n \" \"Plug in your laptop and try again.\" , parent = self , icon = 'warning' ) if not retry : # Cancel button pressed. self . quit_app ( \"AC power not connected.\" ) return False # Non-fatal failure","title":"is_on_ac_power"},{"location":"api/app/#battery_boost.app.App.quit_app","text":"Terminate the application, cancel scheduled jobs, and exit. Parameters: Name Type Description Default status int | str Optional exit code or message. 0 Source code in src/battery_boost/app.py 247 248 249 250 251 252 253 254 255 256 257 258 259 def quit_app ( self , status : int | str = 0 ) -> NoReturn : \"\"\"Terminate the application, cancel scheduled jobs, and exit. Args: status: Optional exit code or message. \"\"\" if self . _refresh_job : try : self . after_cancel ( self . _refresh_job ) except ( tk . TclError , RuntimeError ) as exc : logger . critical ( \"quit_app failed to cancel job %s \" , exc ) self . destroy () sys . exit ( status )","title":"quit_app"},{"location":"api/app/#battery_boost.app.App.quit_on_error","text":"Display Error dialog and quit. Source code in src/battery_boost/app.py 242 243 244 245 def quit_on_error ( self , error_message : str , title : str = \"Error\" ) -> NoReturn : \"\"\"Display Error dialog and quit.\"\"\" messagebox . showerror ( title , error_message , parent = self ) self . quit_app ( f \"Error: { error_message } \" )","title":"quit_on_error"},{"location":"api/app/#battery_boost.app.App.refresh_battery_stats","text":"Periodically refresh the battery statistics. Source code in src/battery_boost/app.py 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 def refresh_battery_stats ( self ) -> None : \"\"\"Periodically refresh the battery statistics.\"\"\" logger . debug ( \"Refreshing battery statistics\" ) new_battery_stats = get_battery_stats () current_battery_info = self . battery_stats [ 'info' ] new_battery_info = new_battery_stats [ 'info' ] # Handle updating button appearance on battery discharge. self . update_button ( new_battery_stats [ 'discharging' ]) # Update text widget info. if current_battery_info != new_battery_info : self . battery_stats = new_battery_stats self . write_stats ( new_battery_info ) # noinspection PyTypeChecker self . _refresh_job = self . after ( REFRESH_INTERVAL_MS , self . refresh_battery_stats )","title":"refresh_battery_stats"},{"location":"api/app/#battery_boost.app.App.toggle_state","text":"Switch between default and full-charge profiles and update the UI. Source code in src/battery_boost/app.py 288 289 290 291 292 293 294 295 296 297 298 299 300 301 def toggle_state ( self ) -> None : \"\"\"Switch between default and full-charge profiles and update the UI.\"\"\" if not tlp_toggle_state ( self , self . ui_state ): return # Flip UI state self . ui_state = ( BatteryState . DEFAULT if self . ui_state == BatteryState . RECHARGE else BatteryState . RECHARGE ) self . apply_state () # Update text widget. self . battery_stats = get_battery_stats () self . write_stats ( self . battery_stats [ 'info' ]) return","title":"toggle_state"},{"location":"api/app/#battery_boost.app.App.update_button","text":"Update button appearance to match battery status. Source code in src/battery_boost/app.py 230 231 232 233 234 235 236 237 238 239 240 def update_button ( self , is_discharging : bool ) -> None : \"\"\"Update button appearance to match battery status.\"\"\" prev_btn_style = self . button . cget ( \"style\" ) if is_discharging : new_style = 'Discharge.TButton' elif self . ui_state is BatteryState . RECHARGE : new_style = 'Recharge.TButton' else : new_style = 'Default.TButton' if new_style != prev_btn_style : self . button . configure ( style = new_style )","title":"update_button"},{"location":"api/app/#battery_boost.app.App.write_stats","text":"Update the text area with the current TLP battery stats. Source code in src/battery_boost/app.py 303 304 305 306 307 308 309 310 311 312 def write_stats ( self , stats : str ) -> None : \"\"\"Update the text area with the current TLP battery stats.\"\"\" stats = STATES [ self . ui_state ][ 'action' ] + stats logger . debug ( stats ) # noinspection PyTypeChecker self . text_box . config ( state = tk . NORMAL ) self . text_box . delete ( '1.0' , tk . END ) self . text_box . insert ( tk . END , stats ) # noinspection PyTypeChecker self . text_box . config ( state = tk . DISABLED )","title":"write_stats"},{"location":"api/authenticate/","text":"battery_boost.authenticate \u00b6 Prompt for and validate sudo credentials for Battery Boost. Provides a GUI dialog to request the user's password and cache sudo credentials for subsequent TLP commands. Exits the program if authentication fails. authenticate \u00b6 Prompt user for sudo password and validate. Runs sudo -v to cache credentials for subsequent commands. Retries up to three times before exiting the program. Exits program if authentication fails. Source code in src/battery_boost/authenticate.py 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 def authenticate ( _parent : App ) -> None : \"\"\"Prompt user for sudo password and validate. Runs `sudo -v` to cache credentials for subsequent commands. Retries up to three times before exiting the program. Exits program if authentication fails. \"\"\" max_tries = 3 for attempt in range ( max_tries ): _password = simpledialog . askstring ( \"Authenticate\" , \"Authentication Required to run Battery Boost. \\n\\n Enter your password:\" , show = \"*\" ) if _password is None : _parent . quit_app ( \"Cancelled.\" ) # Don't strip() - whitespaces are unusual but valid password characters. if not _password : if attempt < max_tries - 1 : messagebox . showerror ( \"Error\" , \"Password required.\" ) continue break try : subprocess . run ([ 'sudo' , '-S' , '-v' ], input = _password + ' \\n ' , text = True , capture_output = True , timeout = 20 , # Unlikely, but better than hanging. check = True ) _password = None # Overwrite password immediately. return except FileNotFoundError : _parent . quit_on_error ( \"sudo not found on this system.\" ) except subprocess . TimeoutExpired : _parent . quit_on_error ( \"Authentication process timed out.\" , \"Fatal Error\" ) except subprocess . CalledProcessError : # Only realistic failure remaining is \"wrong password\". if attempt < max_tries - 1 : messagebox . showerror ( \"Error\" , \"Incorrect password.\" ) except Exception as exc : # pylint: disable=broad-exception-caught # Defensively catch any unexpected errors and quit. _parent . quit_on_error ( f \"Unexpected Error { exc } \" , \"Fatal Error\" ) finally : _password = None # Ensure always cleared. # Failed every attempt. message = f \"Authentication failed { max_tries } times. \\n\\n Click OK to Quit.\" _parent . quit_on_error ( message )","title":"authenticate.py"},{"location":"api/authenticate/#battery_boost.authenticate","text":"Prompt for and validate sudo credentials for Battery Boost. Provides a GUI dialog to request the user's password and cache sudo credentials for subsequent TLP commands. Exits the program if authentication fails.","title":"authenticate"},{"location":"api/authenticate/#battery_boost.authenticate.authenticate","text":"Prompt user for sudo password and validate. Runs sudo -v to cache credentials for subsequent commands. Retries up to three times before exiting the program. Exits program if authentication fails. Source code in src/battery_boost/authenticate.py 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 def authenticate ( _parent : App ) -> None : \"\"\"Prompt user for sudo password and validate. Runs `sudo -v` to cache credentials for subsequent commands. Retries up to three times before exiting the program. Exits program if authentication fails. \"\"\" max_tries = 3 for attempt in range ( max_tries ): _password = simpledialog . askstring ( \"Authenticate\" , \"Authentication Required to run Battery Boost. \\n\\n Enter your password:\" , show = \"*\" ) if _password is None : _parent . quit_app ( \"Cancelled.\" ) # Don't strip() - whitespaces are unusual but valid password characters. if not _password : if attempt < max_tries - 1 : messagebox . showerror ( \"Error\" , \"Password required.\" ) continue break try : subprocess . run ([ 'sudo' , '-S' , '-v' ], input = _password + ' \\n ' , text = True , capture_output = True , timeout = 20 , # Unlikely, but better than hanging. check = True ) _password = None # Overwrite password immediately. return except FileNotFoundError : _parent . quit_on_error ( \"sudo not found on this system.\" ) except subprocess . TimeoutExpired : _parent . quit_on_error ( \"Authentication process timed out.\" , \"Fatal Error\" ) except subprocess . CalledProcessError : # Only realistic failure remaining is \"wrong password\". if attempt < max_tries - 1 : messagebox . showerror ( \"Error\" , \"Incorrect password.\" ) except Exception as exc : # pylint: disable=broad-exception-caught # Defensively catch any unexpected errors and quit. _parent . quit_on_error ( f \"Unexpected Error { exc } \" , \"Fatal Error\" ) finally : _password = None # Ensure always cleared. # Failed every attempt. message = f \"Authentication failed { max_tries } times. \\n\\n Click OK to Quit.\" _parent . quit_on_error ( message )","title":"authenticate"},{"location":"api/constants/","text":"Constants \u00b6 Debug and Refresh Settings \u00b6 Constants and types for the Battery Boost application. DEBUG = False module-attribute \u00b6 Enable debug logging (True/False). REFRESH_INTERVAL_MS = 1000 module-attribute \u00b6 Check TLP battery statistics every second. Must be frequent enough to catch changes in charging status. Themes \u00b6 Constants and types for the Battery Boost application. THEME = _THEME module-attribute \u00b6 Mapping of ThemeName to the corresponding colour scheme. DEFAULT_THEME = THEME [ ThemeName . DARK ] module-attribute \u00b6 Default theme. ThemeName \u00b6 Bases: Enum Available themes. Currently available themes LIGHT: Light theme DARK: Dark theme Source code in src/battery_boost/constants.py 19 20 21 22 23 24 25 26 27 class ThemeName ( Enum ): \"\"\"Available themes. Currently available themes: - LIGHT: Light theme - DARK: Dark theme \"\"\" LIGHT = 'light' DARK = 'dark' ThemeKeys \u00b6 Bases: TypedDict Colours used in the GUI theme for Battery Boost. Attributes: Name Type Description default_bg str Background colour of the main window in normal mode. charge_bg str Background colour when full charge mode is active. text str Colour of standard text. btn_normal str Colour of the button in normal mode. btn_active_normal str Button colour when pressed in normal mode. btn_charge str Colour of the button in full-charge mode. btn_active_charge str Button colour when pressed in full-charge mode. btn_discharge str Colour of the button when battery is discharging. btn_active_discharge str Button colour when pressed while discharging. btn_discharge_text str Text colour for the button while discharging. Source code in src/battery_boost/constants.py 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 class ThemeKeys ( TypedDict ): \"\"\"Colours used in the GUI theme for Battery Boost. Attributes: default_bg: Background colour of the main window in normal mode. charge_bg: Background colour when full charge mode is active. text: Colour of standard text. btn_normal: Colour of the button in normal mode. btn_active_normal: Button colour when pressed in normal mode. btn_charge: Colour of the button in full-charge mode. btn_active_charge: Button colour when pressed in full-charge mode. btn_discharge: Colour of the button when battery is discharging. btn_active_discharge: Button colour when pressed while discharging. btn_discharge_text: Text colour for the button while discharging. \"\"\" default_bg : str charge_bg : str text : str btn_normal : str btn_active_normal : str btn_charge : str btn_active_charge : str btn_discharge : str btn_active_discharge : str btn_discharge_text : str Fonts \u00b6 Constants and types for the Battery Boost application. FontSizeConfig = tuple [ tuple [ str , int ], tuple [ str , int ], float ] module-attribute \u00b6 Font size configuration used by the GUI. Contains (font name, size) for the standard UI font (font name, size) for the small UI font GUI scale factor FONT_SIZES = _FONT_SIZES module-attribute \u00b6 Font configurations for the GUI. Keys: size level (1\u20135) Values: tuple of ((standard font, size), (small font, size), scale factor) Battery State \u00b6 Constants and types for the Battery Boost application. STATES = _STATES module-attribute \u00b6 Mapping of battery state to UI labels and actions. BatteryState \u00b6 Bases: Enum Battery profiles managed by TLP. Source code in src/battery_boost/constants.py 124 125 126 127 class BatteryState ( Enum ): \"\"\"Battery profiles managed by TLP.\"\"\" DEFAULT = 'default' RECHARGE = 'recharge' UIState \u00b6 Bases: TypedDict Labels and actions for the battery state displayed in the GUI. Source code in src/battery_boost/constants.py 130 131 132 133 134 class UIState ( TypedDict ): \"\"\"Labels and actions for the battery state displayed in the GUI.\"\"\" action : str label_text : str button_text : str","title":"consants.py"},{"location":"api/constants/#constants","text":"","title":"Constants"},{"location":"api/constants/#debug-and-refresh-settings","text":"Constants and types for the Battery Boost application.","title":"Debug and Refresh Settings"},{"location":"api/constants/#battery_boost.constants.DEBUG","text":"Enable debug logging (True/False).","title":"DEBUG"},{"location":"api/constants/#battery_boost.constants.REFRESH_INTERVAL_MS","text":"Check TLP battery statistics every second. Must be frequent enough to catch changes in charging status.","title":"REFRESH_INTERVAL_MS"},{"location":"api/constants/#themes","text":"Constants and types for the Battery Boost application.","title":"Themes"},{"location":"api/constants/#battery_boost.constants.THEME","text":"Mapping of ThemeName to the corresponding colour scheme.","title":"THEME"},{"location":"api/constants/#battery_boost.constants.DEFAULT_THEME","text":"Default theme.","title":"DEFAULT_THEME"},{"location":"api/constants/#battery_boost.constants.ThemeName","text":"Bases: Enum Available themes. Currently available themes LIGHT: Light theme DARK: Dark theme Source code in src/battery_boost/constants.py 19 20 21 22 23 24 25 26 27 class ThemeName ( Enum ): \"\"\"Available themes. Currently available themes: - LIGHT: Light theme - DARK: Dark theme \"\"\" LIGHT = 'light' DARK = 'dark'","title":"ThemeName"},{"location":"api/constants/#battery_boost.constants.ThemeKeys","text":"Bases: TypedDict Colours used in the GUI theme for Battery Boost. Attributes: Name Type Description default_bg str Background colour of the main window in normal mode. charge_bg str Background colour when full charge mode is active. text str Colour of standard text. btn_normal str Colour of the button in normal mode. btn_active_normal str Button colour when pressed in normal mode. btn_charge str Colour of the button in full-charge mode. btn_active_charge str Button colour when pressed in full-charge mode. btn_discharge str Colour of the button when battery is discharging. btn_active_discharge str Button colour when pressed while discharging. btn_discharge_text str Text colour for the button while discharging. Source code in src/battery_boost/constants.py 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 class ThemeKeys ( TypedDict ): \"\"\"Colours used in the GUI theme for Battery Boost. Attributes: default_bg: Background colour of the main window in normal mode. charge_bg: Background colour when full charge mode is active. text: Colour of standard text. btn_normal: Colour of the button in normal mode. btn_active_normal: Button colour when pressed in normal mode. btn_charge: Colour of the button in full-charge mode. btn_active_charge: Button colour when pressed in full-charge mode. btn_discharge: Colour of the button when battery is discharging. btn_active_discharge: Button colour when pressed while discharging. btn_discharge_text: Text colour for the button while discharging. \"\"\" default_bg : str charge_bg : str text : str btn_normal : str btn_active_normal : str btn_charge : str btn_active_charge : str btn_discharge : str btn_active_discharge : str btn_discharge_text : str","title":"ThemeKeys"},{"location":"api/constants/#fonts","text":"Constants and types for the Battery Boost application.","title":"Fonts"},{"location":"api/constants/#battery_boost.constants.FontSizeConfig","text":"Font size configuration used by the GUI. Contains (font name, size) for the standard UI font (font name, size) for the small UI font GUI scale factor","title":"FontSizeConfig"},{"location":"api/constants/#battery_boost.constants.FONT_SIZES","text":"Font configurations for the GUI. Keys: size level (1\u20135) Values: tuple of ((standard font, size), (small font, size), scale factor)","title":"FONT_SIZES"},{"location":"api/constants/#battery-state","text":"Constants and types for the Battery Boost application.","title":"Battery State"},{"location":"api/constants/#battery_boost.constants.STATES","text":"Mapping of battery state to UI labels and actions.","title":"STATES"},{"location":"api/constants/#battery_boost.constants.BatteryState","text":"Bases: Enum Battery profiles managed by TLP. Source code in src/battery_boost/constants.py 124 125 126 127 class BatteryState ( Enum ): \"\"\"Battery profiles managed by TLP.\"\"\" DEFAULT = 'default' RECHARGE = 'recharge'","title":"BatteryState"},{"location":"api/constants/#battery_boost.constants.UIState","text":"Bases: TypedDict Labels and actions for the battery state displayed in the GUI. Source code in src/battery_boost/constants.py 130 131 132 133 134 class UIState ( TypedDict ): \"\"\"Labels and actions for the battery state displayed in the GUI.\"\"\" action : str label_text : str button_text : str","title":"UIState"},{"location":"api/helper_functions/","text":"battery_boost.helper_functions \u00b6 Helper functions for Battery Boost. command_on_path \u00b6 Return True if command is available in PATH, else False. Source code in src/battery_boost/helper_functions.py 20 21 22 def command_on_path ( command : str ) -> bool : \"\"\"Return True if command is available in PATH, else False.\"\"\" return bool ( shutil . which ( command )) get_battery_stats \u00b6 Retrieve raw statistics from battery. Failure of tlp_get_stats() may be non-fatal, so we just return the message for display and let the user decide what to do. Returns: Name Type Description BatteryInfo BatteryInfo discharge status, and battery statistics or BatteryInfo an error message. Source code in src/battery_boost/helper_functions.py 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 def get_battery_stats () -> BatteryInfo : \"\"\"Retrieve raw statistics from battery. Failure of `tlp_get_stats()` may be non-fatal, so we just return the message for display and let the user decide what to do. Returns: BatteryInfo: discharge status, and battery statistics or an error message. \"\"\" try : raw_stats = tlp_get_stats () return parse_tlp_stats ( raw_stats ) except TlpCommandError as exc : return { 'discharging' : False , 'info' : f \"Error: { exc } \" } on_ac_power \u00b6 Return True if on AC power, else False. Raises: Type Description RuntimeError If AC power cannot be determined. Source code in src/battery_boost/helper_functions.py 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 def on_ac_power () -> bool : \"\"\"Return True if on AC power, else False. Raises: RuntimeError: If AC power cannot be determined. \"\"\" base = Path ( \"/sys/class/power_supply\" ) if base . is_dir (): for child in base . iterdir (): type_file = child / \"type\" try : # Check for AC adaptor. if type_file . is_file () and type_file . read_text () . strip () == \"Mains\" : # Then check if it online. online_file = child / \"online\" if online_file . is_file (): return online_file . read_text () . strip () == \"1\" except OSError : pass # Unsupported system raise RuntimeError ( \"Power supply information not available.\" ) parse_args \u00b6 Parse command-line arguments and return configuration. Parameters: Name Type Description Default argv list [ str ] List of command-line arguments. required Returns: Name Type Description tuple Config (theme_dict, standard_font, small_font, scale_factor). Source code in src/battery_boost/helper_functions.py 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 def parse_args ( argv : list [ str ]) -> Config : \"\"\"Parse command-line arguments and return configuration. Args: argv: List of command-line arguments. Returns: tuple: (theme_dict, standard_font, small_font, scale_factor). \"\"\" parser = argparse . ArgumentParser ( description = \"A simple GUI to enable `tlp fullcharge`.\" , # Automatically add defaults to help text. formatter_class = argparse . ArgumentDefaultsHelpFormatter ) parser . add_argument ( '-v' , '--version' , action = 'version' , version = f \"Battery Boost { version ( 'tlp-battery-boost' ) } \" ) parser . add_argument ( '-f' , '--font-size' , type = int , choices = range ( 1 , 6 ), default = 3 , metavar = \"{1-5}\" , help = \"Font size [1-5] (1=smallest, 5=largest)\" ) parser . add_argument ( '-t' , '--theme' , choices = [ 'light' , 'dark' ], default = 'light' if DEFAULT_THEME == THEME [ ThemeName . LIGHT ] else 'dark' , help = \"Color theme\" ) parsed_args = parser . parse_args ( argv ) standard_font , small_font , scale_factor = FONT_SIZES [ parsed_args . font_size ] return THEME [ ThemeName ( parsed_args . theme )], standard_font , small_font , scale_factor","title":"helper_functions.py"},{"location":"api/helper_functions/#battery_boost.helper_functions","text":"Helper functions for Battery Boost.","title":"helper_functions"},{"location":"api/helper_functions/#battery_boost.helper_functions.command_on_path","text":"Return True if command is available in PATH, else False. Source code in src/battery_boost/helper_functions.py 20 21 22 def command_on_path ( command : str ) -> bool : \"\"\"Return True if command is available in PATH, else False.\"\"\" return bool ( shutil . which ( command ))","title":"command_on_path"},{"location":"api/helper_functions/#battery_boost.helper_functions.get_battery_stats","text":"Retrieve raw statistics from battery. Failure of tlp_get_stats() may be non-fatal, so we just return the message for display and let the user decide what to do. Returns: Name Type Description BatteryInfo BatteryInfo discharge status, and battery statistics or BatteryInfo an error message. Source code in src/battery_boost/helper_functions.py 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 def get_battery_stats () -> BatteryInfo : \"\"\"Retrieve raw statistics from battery. Failure of `tlp_get_stats()` may be non-fatal, so we just return the message for display and let the user decide what to do. Returns: BatteryInfo: discharge status, and battery statistics or an error message. \"\"\" try : raw_stats = tlp_get_stats () return parse_tlp_stats ( raw_stats ) except TlpCommandError as exc : return { 'discharging' : False , 'info' : f \"Error: { exc } \" }","title":"get_battery_stats"},{"location":"api/helper_functions/#battery_boost.helper_functions.on_ac_power","text":"Return True if on AC power, else False. Raises: Type Description RuntimeError If AC power cannot be determined. Source code in src/battery_boost/helper_functions.py 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 def on_ac_power () -> bool : \"\"\"Return True if on AC power, else False. Raises: RuntimeError: If AC power cannot be determined. \"\"\" base = Path ( \"/sys/class/power_supply\" ) if base . is_dir (): for child in base . iterdir (): type_file = child / \"type\" try : # Check for AC adaptor. if type_file . is_file () and type_file . read_text () . strip () == \"Mains\" : # Then check if it online. online_file = child / \"online\" if online_file . is_file (): return online_file . read_text () . strip () == \"1\" except OSError : pass # Unsupported system raise RuntimeError ( \"Power supply information not available.\" )","title":"on_ac_power"},{"location":"api/helper_functions/#battery_boost.helper_functions.parse_args","text":"Parse command-line arguments and return configuration. Parameters: Name Type Description Default argv list [ str ] List of command-line arguments. required Returns: Name Type Description tuple Config (theme_dict, standard_font, small_font, scale_factor). Source code in src/battery_boost/helper_functions.py 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 def parse_args ( argv : list [ str ]) -> Config : \"\"\"Parse command-line arguments and return configuration. Args: argv: List of command-line arguments. Returns: tuple: (theme_dict, standard_font, small_font, scale_factor). \"\"\" parser = argparse . ArgumentParser ( description = \"A simple GUI to enable `tlp fullcharge`.\" , # Automatically add defaults to help text. formatter_class = argparse . ArgumentDefaultsHelpFormatter ) parser . add_argument ( '-v' , '--version' , action = 'version' , version = f \"Battery Boost { version ( 'tlp-battery-boost' ) } \" ) parser . add_argument ( '-f' , '--font-size' , type = int , choices = range ( 1 , 6 ), default = 3 , metavar = \"{1-5}\" , help = \"Font size [1-5] (1=smallest, 5=largest)\" ) parser . add_argument ( '-t' , '--theme' , choices = [ 'light' , 'dark' ], default = 'light' if DEFAULT_THEME == THEME [ ThemeName . LIGHT ] else 'dark' , help = \"Color theme\" ) parsed_args = parser . parse_args ( argv ) standard_font , small_font , scale_factor = FONT_SIZES [ parsed_args . font_size ] return THEME [ ThemeName ( parsed_args . theme )], standard_font , small_font , scale_factor","title":"parse_args"},{"location":"api/shell_commands/","text":"battery_boost.shell_commands \u00b6 Wrappers for executing TLP system commands in a Tkinter context. Provides functions to initialize, toggle, and query TLP using sudo, with error handling suitable for a GUI application. TlpCommandError \u00b6 Bases: Exception Raised when tlp-stat fails to run properly. Source code in src/battery_boost/shell_commands.py 22 23 class TlpCommandError ( Exception ): \"\"\"Raised when tlp-stat fails to run properly.\"\"\" initialise_tlp \u00b6 Initialize TLP to the default state. Runs sudo tlp start to reset configuration. Shows an error dialog and exits if the command fails. Source code in src/battery_boost/shell_commands.py 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 def initialise_tlp ( _parent : App ) -> None : \"\"\"Initialize TLP to the default state. Runs `sudo tlp start` to reset configuration. Shows an error dialog and exits if the command fails. \"\"\" try : subprocess . run ([ 'sudo' , 'tlp' , 'start' ], check = True , timeout = _TIMEOUT ) return except Exception as exc : # pylint: disable=broad-exception-caught messagebox . showerror ( \"TLP Command Error\" , f \"Could not initialize TLP. \\n { exc } \" , parent = _parent ) _parent . quit_app ( f \"Error: Could not initialize TLP: { exc } \" ) revoke_permissions \u00b6 Revoke cached sudo credentials. Source code in src/battery_boost/shell_commands.py 147 148 149 150 151 152 153 def revoke_permissions () -> None : \"\"\"Revoke cached sudo credentials.\"\"\" try : subprocess . run ([ 'sudo' , '--remove-timestamp' ], check = False ) except Exception : # pylint: disable=broad-exception-caught # Don't raise. App is shutting down. pass tlp_active \u00b6 Return True if TLP is installed, enabled, and has run recently. Source code in src/battery_boost/shell_commands.py 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 def tlp_active () -> bool : \"\"\"Return True if TLP is installed, enabled, and has run recently.\"\"\" try : result = subprocess . run ( [ \"tlp-stat\" , \"-s\" ], capture_output = True , text = True , check = False , # don't raise if tlp-stat exits nonzero timeout = _TIMEOUT ) output = result . stdout state_enabled = False last_run_valid = False for line in output . splitlines (): line = line . strip () . lower () if line . startswith ( \"state\" ) and 'enabled' in line : state_enabled = True if line . startswith ( \"last run\" ) and 'n/a' not in line : last_run_valid = True return state_enabled and last_run_valid except ( subprocess . SubprocessError , FileNotFoundError , UnicodeDecodeError , subprocess . TimeoutExpired ): return False tlp_get_stats \u00b6 Retrieve TLP battery statistics. Runs sudo tlp-stat -b and returns stdout. Raises: Type Description TlpCommandError Exception if the command fails. Source code in src/battery_boost/shell_commands.py 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 def tlp_get_stats () -> str : \"\"\"Retrieve TLP battery statistics. Runs `sudo tlp-stat -b` and returns stdout. Raises: TlpCommandError: Exception if the command fails. \"\"\" try : result = subprocess . run ([ 'sudo' , 'tlp-stat' , '-b' ], text = True , capture_output = True , check = True , timeout = _TIMEOUT ) # pylint: disable=raise-missing-from except subprocess . CalledProcessError as exc : raise TlpCommandError ( f \"Failed to run tlp-stat: \\n { exc . stderr or exc } \" ) except ( OSError , subprocess . TimeoutExpired ) as exc : raise TlpCommandError ( f \"System error while running tlp-stat: { exc } \" ) except Exception as exc : # pylint: disable=broad-exception-caught raise TlpCommandError ( f \"Unexpected error: { exc } \" ) return result . stdout tlp_running \u00b6 Return True if TLP is running, else False. Source code in src/battery_boost/shell_commands.py 133 134 135 136 137 138 139 140 141 142 143 144 def tlp_running () -> bool : \"\"\"Return True if TLP is running, else False.\"\"\" try : result = subprocess . run ([ 'systemctl' , 'is-active' , 'tlp.service' ], capture_output = True , text = True , check = True , timeout = _TIMEOUT ) return result . stdout . strip () == 'active' except ( subprocess . CalledProcessError , subprocess . TimeoutExpired ): return False tlp_toggle_state \u00b6 Toggle TLP between default and full-charge profiles. Parameters: Name Type Description Default _parent App The Tkinter api instance, used for error dialogs. required current_state BatteryState The current battery profile. required Returns: True if successful, False otherwise. Source code in src/battery_boost/shell_commands.py 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 def tlp_toggle_state ( _parent : App , current_state : BatteryState ) -> bool : \"\"\"Toggle TLP between default and full-charge profiles. Args: _parent: The Tkinter api instance, used for error dialogs. current_state: The current battery profile. Returns: True if successful, False otherwise. \"\"\" try : if current_state == BatteryState . DEFAULT : subprocess . run ([ 'sudo' , 'tlp' , 'fullcharge' ], check = True , capture_output = True , timeout = _TIMEOUT ) else : subprocess . run ([ 'sudo' , 'tlp' , 'start' ], check = True , capture_output = True , timeout = _TIMEOUT ) except FileNotFoundError as exc : _parent . quit_on_error ( f \"Command not found: { exc . filename } \" , \"TLP Command Error\" ) except subprocess . CalledProcessError as exc : # Special case:fullcharge requires AC power. if not _parent . is_on_ac_power (): return False # Non-fatal failure _parent . quit_on_error ( f \"TLP command failed: { exc . returncode } : \\n \" f \" { exc . stderr or exc } \" , \"TLP Command Error\" ) except ( OSError , subprocess . TimeoutExpired ) as exc : _parent . quit_on_error ( f \"System error while running TLP command: { exc } \" , \"TLP Command Error\" ) return True","title":"shell_commands.py"},{"location":"api/shell_commands/#battery_boost.shell_commands","text":"Wrappers for executing TLP system commands in a Tkinter context. Provides functions to initialize, toggle, and query TLP using sudo, with error handling suitable for a GUI application.","title":"shell_commands"},{"location":"api/shell_commands/#battery_boost.shell_commands.TlpCommandError","text":"Bases: Exception Raised when tlp-stat fails to run properly. Source code in src/battery_boost/shell_commands.py 22 23 class TlpCommandError ( Exception ): \"\"\"Raised when tlp-stat fails to run properly.\"\"\"","title":"TlpCommandError"},{"location":"api/shell_commands/#battery_boost.shell_commands.initialise_tlp","text":"Initialize TLP to the default state. Runs sudo tlp start to reset configuration. Shows an error dialog and exits if the command fails. Source code in src/battery_boost/shell_commands.py 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 def initialise_tlp ( _parent : App ) -> None : \"\"\"Initialize TLP to the default state. Runs `sudo tlp start` to reset configuration. Shows an error dialog and exits if the command fails. \"\"\" try : subprocess . run ([ 'sudo' , 'tlp' , 'start' ], check = True , timeout = _TIMEOUT ) return except Exception as exc : # pylint: disable=broad-exception-caught messagebox . showerror ( \"TLP Command Error\" , f \"Could not initialize TLP. \\n { exc } \" , parent = _parent ) _parent . quit_app ( f \"Error: Could not initialize TLP: { exc } \" )","title":"initialise_tlp"},{"location":"api/shell_commands/#battery_boost.shell_commands.revoke_permissions","text":"Revoke cached sudo credentials. Source code in src/battery_boost/shell_commands.py 147 148 149 150 151 152 153 def revoke_permissions () -> None : \"\"\"Revoke cached sudo credentials.\"\"\" try : subprocess . run ([ 'sudo' , '--remove-timestamp' ], check = False ) except Exception : # pylint: disable=broad-exception-caught # Don't raise. App is shutting down. pass","title":"revoke_permissions"},{"location":"api/shell_commands/#battery_boost.shell_commands.tlp_active","text":"Return True if TLP is installed, enabled, and has run recently. Source code in src/battery_boost/shell_commands.py 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 def tlp_active () -> bool : \"\"\"Return True if TLP is installed, enabled, and has run recently.\"\"\" try : result = subprocess . run ( [ \"tlp-stat\" , \"-s\" ], capture_output = True , text = True , check = False , # don't raise if tlp-stat exits nonzero timeout = _TIMEOUT ) output = result . stdout state_enabled = False last_run_valid = False for line in output . splitlines (): line = line . strip () . lower () if line . startswith ( \"state\" ) and 'enabled' in line : state_enabled = True if line . startswith ( \"last run\" ) and 'n/a' not in line : last_run_valid = True return state_enabled and last_run_valid except ( subprocess . SubprocessError , FileNotFoundError , UnicodeDecodeError , subprocess . TimeoutExpired ): return False","title":"tlp_active"},{"location":"api/shell_commands/#battery_boost.shell_commands.tlp_get_stats","text":"Retrieve TLP battery statistics. Runs sudo tlp-stat -b and returns stdout. Raises: Type Description TlpCommandError Exception if the command fails. Source code in src/battery_boost/shell_commands.py 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 def tlp_get_stats () -> str : \"\"\"Retrieve TLP battery statistics. Runs `sudo tlp-stat -b` and returns stdout. Raises: TlpCommandError: Exception if the command fails. \"\"\" try : result = subprocess . run ([ 'sudo' , 'tlp-stat' , '-b' ], text = True , capture_output = True , check = True , timeout = _TIMEOUT ) # pylint: disable=raise-missing-from except subprocess . CalledProcessError as exc : raise TlpCommandError ( f \"Failed to run tlp-stat: \\n { exc . stderr or exc } \" ) except ( OSError , subprocess . TimeoutExpired ) as exc : raise TlpCommandError ( f \"System error while running tlp-stat: { exc } \" ) except Exception as exc : # pylint: disable=broad-exception-caught raise TlpCommandError ( f \"Unexpected error: { exc } \" ) return result . stdout","title":"tlp_get_stats"},{"location":"api/shell_commands/#battery_boost.shell_commands.tlp_running","text":"Return True if TLP is running, else False. Source code in src/battery_boost/shell_commands.py 133 134 135 136 137 138 139 140 141 142 143 144 def tlp_running () -> bool : \"\"\"Return True if TLP is running, else False.\"\"\" try : result = subprocess . run ([ 'systemctl' , 'is-active' , 'tlp.service' ], capture_output = True , text = True , check = True , timeout = _TIMEOUT ) return result . stdout . strip () == 'active' except ( subprocess . CalledProcessError , subprocess . TimeoutExpired ): return False","title":"tlp_running"},{"location":"api/shell_commands/#battery_boost.shell_commands.tlp_toggle_state","text":"Toggle TLP between default and full-charge profiles. Parameters: Name Type Description Default _parent App The Tkinter api instance, used for error dialogs. required current_state BatteryState The current battery profile. required Returns: True if successful, False otherwise. Source code in src/battery_boost/shell_commands.py 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 def tlp_toggle_state ( _parent : App , current_state : BatteryState ) -> bool : \"\"\"Toggle TLP between default and full-charge profiles. Args: _parent: The Tkinter api instance, used for error dialogs. current_state: The current battery profile. Returns: True if successful, False otherwise. \"\"\" try : if current_state == BatteryState . DEFAULT : subprocess . run ([ 'sudo' , 'tlp' , 'fullcharge' ], check = True , capture_output = True , timeout = _TIMEOUT ) else : subprocess . run ([ 'sudo' , 'tlp' , 'start' ], check = True , capture_output = True , timeout = _TIMEOUT ) except FileNotFoundError as exc : _parent . quit_on_error ( f \"Command not found: { exc . filename } \" , \"TLP Command Error\" ) except subprocess . CalledProcessError as exc : # Special case:fullcharge requires AC power. if not _parent . is_on_ac_power (): return False # Non-fatal failure _parent . quit_on_error ( f \"TLP command failed: { exc . returncode } : \\n \" f \" { exc . stderr or exc } \" , \"TLP Command Error\" ) except ( OSError , subprocess . TimeoutExpired ) as exc : _parent . quit_on_error ( f \"System error while running TLP command: { exc } \" , \"TLP Command Error\" ) return True","title":"tlp_toggle_state"},{"location":"api/tlp_parser/","text":"battery_boost.tlp_parser \u00b6 Parsing utilities for interpreting tlp-stat -b output. BatteryInfo \u00b6 Bases: TypedDict Battery info object. Source code in src/battery_boost/tlp_parser.py 9 10 11 12 class BatteryInfo ( TypedDict ): \"\"\"Battery info object.\"\"\" discharging : bool info : str parse_tlp_stats \u00b6 Parse TLP battery stats and return a human-readable summary. Parameters: Name Type Description Default tlp_stats str Output string from tlp_get_stats() . required Returns: Name Type Description BatteryInfo BatteryInfo discharge status, and battery statistics or an error message. Source code in src/battery_boost/tlp_parser.py 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 def parse_tlp_stats ( tlp_stats : str ) -> BatteryInfo : \"\"\"Parse TLP battery stats and return a human-readable summary. Args: tlp_stats: Output string from `tlp_get_stats()`. Returns: BatteryInfo: discharge status, and battery statistics or an error message. \"\"\" if not tlp_stats . strip (): return { 'discharging' : False , 'info' : \"No battery data found.\" } is_discharging = False lines = tlp_stats . splitlines () stats = [] current_battery = \"\" battery_info : defaultdict [ str , str ] = defaultdict ( lambda : UNKNOWN ) for line in lines : line = line . strip () # Detect start of a new battery section if line . startswith ( '+++ ' ) and 'Battery Status:' in line : # Save previous battery (if any) if current_battery : stats . append ( _format_battery_str ( current_battery , battery_info )) # Start new one try : current_battery = line . split ( 'Battery Status:' )[ 1 ] . strip () except IndexError : pass battery_info = defaultdict ( lambda : UNKNOWN ) continue # Parse values. if 'charge_control_start_threshold' in line : battery_info [ 'start' ] = _get_battery_value ( line ) elif 'charge_control_end_threshold' in line : battery_info [ 'end' ] = _get_battery_value ( line ) elif line . startswith ( 'Charge' ): battery_info [ 'charge' ] = _get_battery_value ( line ) elif line . startswith ( 'Capacity' ): battery_info [ 'capacity' ] = _get_battery_value ( line ) elif 'status' in line : battery_info [ 'status' ] = _get_battery_status ( line ) if battery_info [ 'status' ] . strip () . lower () == 'discharging' : is_discharging = True # If any batery is discharging. # Add the last battery if current_battery and battery_info : stats . append ( _format_battery_str ( current_battery , battery_info )) info = ' \\n ' . join ( stats ) if stats else \"No battery data found.\" return { 'discharging' : is_discharging , 'info' : info }","title":"tlp_parser.py"},{"location":"api/tlp_parser/#battery_boost.tlp_parser","text":"Parsing utilities for interpreting tlp-stat -b output.","title":"tlp_parser"},{"location":"api/tlp_parser/#battery_boost.tlp_parser.BatteryInfo","text":"Bases: TypedDict Battery info object. Source code in src/battery_boost/tlp_parser.py 9 10 11 12 class BatteryInfo ( TypedDict ): \"\"\"Battery info object.\"\"\" discharging : bool info : str","title":"BatteryInfo"},{"location":"api/tlp_parser/#battery_boost.tlp_parser.parse_tlp_stats","text":"Parse TLP battery stats and return a human-readable summary. Parameters: Name Type Description Default tlp_stats str Output string from tlp_get_stats() . required Returns: Name Type Description BatteryInfo BatteryInfo discharge status, and battery statistics or an error message. Source code in src/battery_boost/tlp_parser.py 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 def parse_tlp_stats ( tlp_stats : str ) -> BatteryInfo : \"\"\"Parse TLP battery stats and return a human-readable summary. Args: tlp_stats: Output string from `tlp_get_stats()`. Returns: BatteryInfo: discharge status, and battery statistics or an error message. \"\"\" if not tlp_stats . strip (): return { 'discharging' : False , 'info' : \"No battery data found.\" } is_discharging = False lines = tlp_stats . splitlines () stats = [] current_battery = \"\" battery_info : defaultdict [ str , str ] = defaultdict ( lambda : UNKNOWN ) for line in lines : line = line . strip () # Detect start of a new battery section if line . startswith ( '+++ ' ) and 'Battery Status:' in line : # Save previous battery (if any) if current_battery : stats . append ( _format_battery_str ( current_battery , battery_info )) # Start new one try : current_battery = line . split ( 'Battery Status:' )[ 1 ] . strip () except IndexError : pass battery_info = defaultdict ( lambda : UNKNOWN ) continue # Parse values. if 'charge_control_start_threshold' in line : battery_info [ 'start' ] = _get_battery_value ( line ) elif 'charge_control_end_threshold' in line : battery_info [ 'end' ] = _get_battery_value ( line ) elif line . startswith ( 'Charge' ): battery_info [ 'charge' ] = _get_battery_value ( line ) elif line . startswith ( 'Capacity' ): battery_info [ 'capacity' ] = _get_battery_value ( line ) elif 'status' in line : battery_info [ 'status' ] = _get_battery_status ( line ) if battery_info [ 'status' ] . strip () . lower () == 'discharging' : is_discharging = True # If any batery is discharging. # Add the last battery if current_battery and battery_info : stats . append ( _format_battery_str ( current_battery , battery_info )) info = ' \\n ' . join ( stats ) if stats else \"No battery data found.\" return { 'discharging' : is_discharging , 'info' : info }","title":"parse_tlp_stats"}]}